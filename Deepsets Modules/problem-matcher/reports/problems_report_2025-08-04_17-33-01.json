{
    "timestamp": "2025-08-04T16:33:01+00:00",
    "total_issues": 206,
    "defined_functions_count": 40,
    "problems": [
        {
            "file": "account.php",
            "line": 31,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"makegroup\"]) && $_POST[\"makegroup\"]==\"Create group\" ) {"
        },
        {
            "file": "account.php",
            "line": 33,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'insert into communities ( member_ID , community_name , password ) values ( '.$_SESSION['member_ID'].' , '.qq($_POST[\"groupname\"]).' , '.qq($_POST[\"grouppassword\"]).' )';"
        },
        {
            "file": "account.php",
            "line": 37,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from communities where community_name = '.qq($_POST[\"groupname\"]).' and member_ID = '.$_SESSION[\"member_ID\"].'';"
        },
        {
            "file": "account.php",
            "line": 48,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"deletegroup\"]) && $_POST[\"deletegroup\"]>0 ) {"
        },
        {
            "file": "account.php",
            "line": 50,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "echo $query = 'delete from communities where community_ID = '.$_POST[\"deletegroup\"];"
        },
        {
            "file": "account.php",
            "line": 65,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST['submitcount']==\"Submit\" ) {"
        },
        {
            "file": "account.php",
            "line": 67,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "for ($i=1; $i<=$_POST['rowcount']; $i++) {"
        },
        {
            "file": "account.php",
            "line": 70,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( isset($_POST[$varname]) ) {"
        },
        {
            "file": "account.php",
            "line": 72,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from member_communities where member_ID = '.$_SESSION['member_ID'].' and community_ID = '.$_POST[$varname];"
        },
        {
            "file": "account.php",
            "line": 79,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = \"insert into member_communities ( member_ID, community_ID ) values ( '\".$_SESSION['member_ID'].\"' , '\".$_POST[$varname].\"' )\";"
        },
        {
            "file": "account.php",
            "line": 83,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = \"delete from member_communities where member_ID = \".$_SESSION['member_ID'].\" and  community_ID = \".$_POST[$varnameb];"
        },
        {
            "file": "account.php",
            "line": 91,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST['submit2'] == \"Re-save\") {"
        },
        {
            "file": "account.php",
            "line": 95,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$fname = secure_input($_POST['fname'], 'string');"
        },
        {
            "file": "account.php",
            "line": 96,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$lname = secure_input($_POST['lname'], 'string');"
        },
        {
            "file": "account.php",
            "line": 97,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$email = secure_input($_POST['email'], 'email');"
        },
        {
            "file": "account.php",
            "line": 98,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$password = secure_input($_POST['pagespass'], 'string');"
        },
        {
            "file": "account.php",
            "line": 98,
            "severity": "SECURITY",
            "message": "Plain text password storage",
            "code": "$password = secure_input($_POST['pagespass'], 'string');"
        },
        {
            "file": "account.php",
            "line": 99,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$pcode = secure_input($_POST['pcode'], 'string');"
        },
        {
            "file": "add_listing.php",
            "line": 26,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo 'thing_ID is '.$_POST[\"thing_ID\"];"
        },
        {
            "file": "add_listing.php",
            "line": 27,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = isset($_POST[\"thing_ID\"]) ? $_POST[\"thing_ID\"] : 0;"
        },
        {
            "file": "add_listing.php",
            "line": 30,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"checkword\"]) && $_POST[\"checkword\"] == \"check\") {"
        },
        {
            "file": "add_listing.php",
            "line": 31,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_POST[\"thing_ID\"] == 0) {"
        },
        {
            "file": "add_listing.php",
            "line": 34,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_title\"]).\", \"."
        },
        {
            "file": "add_listing.php",
            "line": 35,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_price\"]).\", \"."
        },
        {
            "file": "add_listing.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_type\"]).\", \"."
        },
        {
            "file": "add_listing.php",
            "line": 37,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_ratio\"]).\", \"."
        },
        {
            "file": "add_listing.php",
            "line": 38,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_description\"]).\", \"."
        },
        {
            "file": "add_listing.php",
            "line": 40,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_image\"]).\" )\";"
        },
        {
            "file": "add_listing.php",
            "line": 49,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = $_POST[\"thing_ID\"];"
        },
        {
            "file": "add_listing.php",
            "line": 51,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_description = \".qq($_POST[\"thing_description\"]).\" ,\"."
        },
        {
            "file": "add_listing.php",
            "line": 52,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_price       = \".qq($_POST[\"thing_price\"]).\" ,\"."
        },
        {
            "file": "add_listing.php",
            "line": 53,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_type        = \".qq($_POST[\"thing_type\"]).\" ,\"."
        },
        {
            "file": "add_listing.php",
            "line": 54,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_ratio       = \".qq($_POST[\"thing_ratio\"]).\" ,\"."
        },
        {
            "file": "add_listing.php",
            "line": 55,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_title       = \".qq($_POST[\"thing_title\"]).\" \"."
        },
        {
            "file": "add_listing.php",
            "line": 64,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo '<br>num comms = '.$_POST[\"num_comms\"];"
        },
        {
            "file": "add_listing.php",
            "line": 71,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "for ( $i=1; $i<=$_POST[\"num_comms\"]; $i++) {"
        },
        {
            "file": "add_listing.php",
            "line": 73,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$temp2 = $_POST[$temp3];"
        },
        {
            "file": "add_listing.php",
            "line": 96,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"edit\"])) {"
        },
        {
            "file": "add_listing.php",
            "line": 107,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "} elseif ( isset($_POST[\"item_delete\"]) ) {"
        },
        {
            "file": "create_private.php",
            "line": 56,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo 'thing_ID is '.$_POST[\"thing_ID\"];"
        },
        {
            "file": "create_private.php",
            "line": 57,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = $_POST[\"thing_ID\"];"
        },
        {
            "file": "create_private.php",
            "line": 62,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST[\"checkword\"] == \"check\") {"
        },
        {
            "file": "create_private.php",
            "line": 63,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_POST[\"thing_ID\"] == 0) {"
        },
        {
            "file": "create_private.php",
            "line": 66,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_title\"]).\", \"."
        },
        {
            "file": "create_private.php",
            "line": 67,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_price\"]).\", \"."
        },
        {
            "file": "create_private.php",
            "line": 68,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_type\"]).\", \"."
        },
        {
            "file": "create_private.php",
            "line": 69,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_ratio\"]).\", \"."
        },
        {
            "file": "create_private.php",
            "line": 70,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_description\"]).\", \"."
        },
        {
            "file": "create_private.php",
            "line": 72,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_image\"]).\" )\";"
        },
        {
            "file": "create_private.php",
            "line": 81,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = $_POST[\"thing_ID\"];"
        },
        {
            "file": "create_private.php",
            "line": 83,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_description = \".qq($_POST[\"thing_description\"]).\" ,\"."
        },
        {
            "file": "create_private.php",
            "line": 84,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_price       = \".qq($_POST[\"thing_price\"]).\" ,\"."
        },
        {
            "file": "create_private.php",
            "line": 85,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_type        = \".qq($_POST[\"thing_type\"]).\" ,\"."
        },
        {
            "file": "create_private.php",
            "line": 86,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_ratio       = \".qq($_POST[\"thing_ratio\"]).\" ,\"."
        },
        {
            "file": "create_private.php",
            "line": 87,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_title       = \".qq($_POST[\"thing_title\"]).\" \"."
        },
        {
            "file": "index.php",
            "line": 14,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"Login\"]) && $_POST[\"Login\"]==\"Login\"){ include(\"includes\/login_process.inc\");};"
        },
        {
            "file": "index.php",
            "line": 15,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_GET['logout']) && $_GET['logout']==1)     { include(\"includes\/logout_process.inc\");}"
        },
        {
            "file": "index.php",
            "line": 21,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_GET[\"showlogin\"]) && $_GET[\"showlogin\"]==1 )  { include(\"includes\/login_form.inc\");}"
        },
        {
            "file": "joingroup.php",
            "line": 26,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"joingroup\"]) ) {"
        },
        {
            "file": "joingroup.php",
            "line": 27,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from members where member_email = '.qq($_POST[\"groupemail\"]);"
        },
        {
            "file": "joingroup.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from communities where member_ID = '.$record[\"member_ID\"].' and password = '.qq($_POST[\"grouppassword\"]);"
        },
        {
            "file": "joingroup.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Plain text password storage",
            "code": "$query = 'select * from communities where member_ID = '.$record[\"member_ID\"].' and password = '.qq($_POST[\"grouppassword\"]);"
        },
        {
            "file": "my_bookings.php",
            "line": 18,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"action\"]) && isset($_POST[\"booking_id\"]) && $_POST[\"action\"] == \"approve\" && $_POST[\"booking_id\"]) {"
        },
        {
            "file": "my_bookings.php",
            "line": 19,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$result = update_booking_status($_POST[\"booking_id\"], 2, $_SESSION[\"member_ID\"]);"
        },
        {
            "file": "my_bookings.php",
            "line": 27,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"action\"]) && isset($_POST[\"booking_id\"]) && $_POST[\"action\"] == \"decline\" && $_POST[\"booking_id\"]) {"
        },
        {
            "file": "my_bookings.php",
            "line": 28,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$result = update_booking_status($_POST[\"booking_id\"], 5, $_SESSION[\"member_ID\"]);"
        },
        {
            "file": "my_bookings.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"action\"]) && isset($_POST[\"booking_id\"]) && $_POST[\"action\"] == \"mark_returned\" && $_POST[\"booking_id\"]) {"
        },
        {
            "file": "my_bookings.php",
            "line": 38,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "WHERE booking_ID = \".qq($_POST[\"booking_id\"]).\""
        },
        {
            "file": "notifications.php",
            "line": 24,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"mark_read\"]) && $_POST[\"mark_read\"] && isset($_POST[\"notification_id\"])) {"
        },
        {
            "file": "notifications.php",
            "line": 25,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "mark_notification_read($_POST[\"notification_id\"], $_SESSION[\"member_ID\"]);"
        },
        {
            "file": "notifications.php",
            "line": 30,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"mark_all_read\"]) && $_POST[\"mark_all_read\"]) {"
        },
        {
            "file": "notifications.php",
            "line": 99,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"update_preferences\"]) && $_POST[\"update_preferences\"]) {"
        },
        {
            "file": "notifications.php",
            "line": 100,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$email_notifications = isset($_POST[\"email_notifications\"]) ? 1 : 0;"
        },
        {
            "file": "notifications.php",
            "line": 101,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$sms_notifications = isset($_POST[\"sms_notifications\"]) ? 1 : 0;"
        },
        {
            "file": "notifications.php",
            "line": 102,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$phone_number = isset($_POST[\"phone_number\"]) ? $_POST[\"phone_number\"] : '';"
        },
        {
            "file": "notifications.php",
            "line": 103,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$notification_frequency = isset($_POST[\"notification_frequency\"]) ? $_POST[\"notification_frequency\"] : 'immediate';"
        },
        {
            "file": "notifications.php",
            "line": 141,
            "severity": "UNDEFINED_FUNCTION",
            "message": "Undefined function 'Immediate'",
            "code": "'immediate' => 'Immediate (as they happen)',"
        },
        {
            "file": "notifications.php",
            "line": 142,
            "severity": "UNDEFINED_FUNCTION",
            "message": "Undefined function 'digest'",
            "code": "'daily' => 'Daily digest (once per day)',"
        },
        {
            "file": "notifications.php",
            "line": 143,
            "severity": "UNDEFINED_FUNCTION",
            "message": "Undefined function 'digest'",
            "code": "'weekly' => 'Weekly digest (once per week)'"
        },
        {
            "file": "register.php",
            "line": 31,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$pagespass = isset($_POST['pagespass']) ? $_POST['pagespass'] : '';"
        },
        {
            "file": "register.php",
            "line": 32,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/$member_email = $_POST['email'];"
        },
        {
            "file": "register.php",
            "line": 37,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST['submitcount']) && $_POST['submitcount']==\"Submit\" ) {"
        },
        {
            "file": "register.php",
            "line": 39,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo '<BR>'.$_POST['submitcount'];"
        },
        {
            "file": "register.php",
            "line": 40,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo '<BR>'.$_POST['rowcount'];"
        },
        {
            "file": "register.php",
            "line": 44,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "for ($i=1; $i<=$_POST['rowcount']; $i++) {"
        },
        {
            "file": "register.php",
            "line": 46,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = \"insert into member_communities ( member_ID, community_ID ) values ( '\".$_SESSION['member_ID'].\"' , '\".$_POST[$varname].\"' )\";"
        },
        {
            "file": "register.php",
            "line": 53,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST['submit2']) && $_POST['submit2'] == \"Register\") {"
        },
        {
            "file": "register.php",
            "line": 56,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$email = secure_input($_POST['email'], 'email');"
        },
        {
            "file": "register.php",
            "line": 57,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$fname = secure_input($_POST['fname'], 'string');"
        },
        {
            "file": "register.php",
            "line": 58,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$lname = secure_input($_POST['lname'], 'string');"
        },
        {
            "file": "register.php",
            "line": 59,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$pcode = secure_input($_POST['pcode'], 'string');"
        },
        {
            "file": "register.php",
            "line": 60,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$password = secure_input($_POST['pagespass'], 'string');"
        },
        {
            "file": "register.php",
            "line": 60,
            "severity": "SECURITY",
            "message": "Plain text password storage",
            "code": "$password = secure_input($_POST['pagespass'], 'string');"
        },
        {
            "file": "register.php",
            "line": 107,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$pcode5 = substr($_POST[\"pcode\"],0,5).\"*\"; $pcode6 = substr($_POST[\"pcode\"],0,6).\"*\"; $pcode7 = substr($_POST[\"pcode\"],0,7).\"*\"; $pcode8 = substr($_POST[\"pcode\"],0,8);"
        },
        {
            "file": "request_booking.php",
            "line": 26,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$thing_ID = isset($_GET[\"thing_id\"]) ? intval($_GET[\"thing_id\"]) : 0;"
        },
        {
            "file": "request_booking.php",
            "line": 51,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"submit_booking\"]) && $_POST[\"submit_booking\"] && !$error_message) {"
        },
        {
            "file": "request_booking.php",
            "line": 52,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$start_date = $_POST[\"start_date\"];"
        },
        {
            "file": "request_booking.php",
            "line": 53,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$end_date = $_POST[\"end_date\"];"
        },
        {
            "file": "request_booking.php",
            "line": 54,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$notes = $_POST[\"notes\"];"
        },
        {
            "file": "request_booking.php",
            "line": 111,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "echo cell2(\"Start Date:\", '<input type=\"date\" name=\"start_date\" value=\"'.$_POST['start_date'].'\" class=\"date-input\" min=\"'.date('Y-m-d').'\" required>');"
        },
        {
            "file": "request_booking.php",
            "line": 112,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "echo cell2(\"End Date:\", '<input type=\"date\" name=\"end_date\" value=\"'.$_POST['end_date'].'\" class=\"date-input\" min=\"'.date('Y-m-d').'\" required>');"
        },
        {
            "file": "request_booking.php",
            "line": 115,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "echo '<tr><td width=\"200\">Special requests or notes:<\/td><td><textarea name=\"notes\" class=\"notes-input\" placeholder=\"Any special requests, pickup arrangements, etc.\">'.$_POST['notes'].'<\/textarea><\/td><\/tr>';"
        },
        {
            "file": "request_booking.php",
            "line": 160,
            "severity": "UNDEFINED_FUNCTION",
            "message": "Undefined function 'toFixed'",
            "code": "'<strong>Total Cost:<\/strong> \u00a3' + totalCost.toFixed(2) + ' (' + days + ' \u00d7 \u00a3' + pricePerDay + ')';"
        },
        {
            "file": "search.php",
            "line": 22,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$keywords_value = isset($_POST[\"keywords\"]) ? $_POST[\"keywords\"] : '';"
        },
        {
            "file": "search.php",
            "line": 25,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$item_type = isset($_POST[\"item_type\"]) ? $_POST[\"item_type\"] : 1;"
        },
        {
            "file": "search.php",
            "line": 28,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "} elseif ($_POST[\"item_type\"]==2) {"
        },
        {
            "file": "search.php",
            "line": 40,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"item_ID\"])) {"
        },
        {
            "file": "search.php",
            "line": 42,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$item_id = secure_input($_POST[\"item_ID\"], 'int');"
        },
        {
            "file": "search.php",
            "line": 67,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"search\"])) {"
        },
        {
            "file": "search.php",
            "line": 69,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_POST[\"item_type\"]==1){"
        },
        {
            "file": "search.php",
            "line": 71,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "} elseif ($_POST[\"item_type\"]==2) {"
        },
        {
            "file": "search.php",
            "line": 79,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$keywords = secure_input($_POST[\"keywords\"], 'string');"
        },
        {
            "file": "search.php",
            "line": 96,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$item_type = secure_input($_POST[\"item_type\"], 'int');"
        },
        {
            "file": "search.php",
            "line": 111,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$button3 = '<input type=\"hidden\" name=\"keywords\" value=\"'.$_POST[\"keywords\"] .'\">';"
        },
        {
            "file": "search.php",
            "line": 112,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$button4 = '<input type=\"hidden\" name=\"item_type\" value=\"'.$_POST[\"item_type\"] .'\">';"
        },
        {
            "file": "search.php",
            "line": 113,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$button5 = '<input type=\"hidden\" name=\"search\" value=\"'.$_POST[\"search\"] .'\">';"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 30,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"makegroup\"]) && $_POST[\"makegroup\"]==\"Create group\" ) {"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 32,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'insert into communities ( member_ID , community_name , password ) values ( '.$_SESSION['member_ID'].' , '.qq($_POST[\"groupname\"]).' , '.qq($_POST[\"grouppassword\"]).' )';"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from communities where community_name = '.qq($_POST[\"groupname\"]).' and member_ID = '.$_SESSION[\"member_ID\"].'';"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 47,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"deletegroup\"]) && $_POST[\"deletegroup\"]>0 ) {"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 49,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "echo $query = 'delete from communities where community_ID = '.$_POST[\"deletegroup\"];"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 64,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST['submitcount']==\"Submit\" ) {"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 66,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "for ($i=1; $i<=$_POST['rowcount']; $i++) {"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 69,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( isset($_POST[$varname]) ) {"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 71,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from member_communities where member_ID = '.$_SESSION['member_ID'].' and community_ID = '.$_POST[$varname];"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 78,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = \"insert into member_communities ( member_ID, community_ID ) values ( '\".$_SESSION['member_ID'].\"' , '\".$_POST[$varname].\"' )\";"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 82,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = \"delete from member_communities where member_ID = \".$_SESSION['member_ID'].\" and  community_ID = \".$_POST[$varnameb];"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 90,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST['submit2'] == \"Re-save\") {"
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 92,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "'member_fname = '.qq($_POST['fname']).' , '."
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 93,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "'member_lname = '.qq($_POST['lname']).' , '."
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 94,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "'member_email = '.qq($_POST['email']).' , '."
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 95,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "'member_password = '.qq($_POST['pagespass']).' , '."
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 95,
            "severity": "SECURITY",
            "message": "Plain text password storage",
            "code": "'member_password = '.qq($_POST['pagespass']).' , '."
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 96,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "'member_pcode = '.qq($_POST['pcode']).' '."
        },
        {
            "file": "archives\/Sharing\/account.php",
            "line": 101,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$_SESSION['member_email'] = $_POST['email'];"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 20,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo 'thing_ID is '.$_POST[\"thing_ID\"];"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 21,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = $_POST[\"thing_ID\"];"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 24,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST[\"checkword\"] == \"check\") {"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 25,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_POST[\"thing_ID\"] == 0) {"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 28,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_title\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 29,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_price\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 30,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_type\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 31,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_ratio\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 32,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_description\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 34,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_image\"]).\" )\";"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 43,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = $_POST[\"thing_ID\"];"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 45,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_description = \".qq($_POST[\"thing_description\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 46,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_price       = \".qq($_POST[\"thing_price\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 47,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_type        = \".qq($_POST[\"thing_type\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 48,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_ratio       = \".qq($_POST[\"thing_ratio\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 49,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_title       = \".qq($_POST[\"thing_title\"]).\" \"."
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 58,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo '<br>num comms = '.$_POST[\"num_comms\"];"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 65,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "for ( $i=1; $i<=$_POST[\"num_comms\"]; $i++) {"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 67,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$temp2 = $_POST[$temp3];"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 90,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"edit\"])) {"
        },
        {
            "file": "archives\/Sharing\/add_listing.php",
            "line": 101,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "} elseif ( isset($_POST[\"item_delete\"]) ) {"
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 56,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo 'thing_ID is '.$_POST[\"thing_ID\"];"
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 57,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = $_POST[\"thing_ID\"];"
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 62,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST[\"checkword\"] == \"check\") {"
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 63,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_POST[\"thing_ID\"] == 0) {"
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 66,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_title\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 67,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_price\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 68,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_type\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 69,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_ratio\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 70,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_description\"]).\", \"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 72,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "qq($_POST[\"thing_image\"]).\" )\";"
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 81,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$this_thing_ID = $_POST[\"thing_ID\"];"
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 83,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_description = \".qq($_POST[\"thing_description\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 84,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_price       = \".qq($_POST[\"thing_price\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 85,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_type        = \".qq($_POST[\"thing_type\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 86,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_ratio       = \".qq($_POST[\"thing_ratio\"]).\" ,\"."
        },
        {
            "file": "archives\/Sharing\/create_private.php",
            "line": 87,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\" thing_title       = \".qq($_POST[\"thing_title\"]).\" \"."
        },
        {
            "file": "archives\/Sharing\/index.php",
            "line": 14,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST[\"Login\"]==\"Login\"){ include(\"includes\/login_process.inc\");};"
        },
        {
            "file": "archives\/Sharing\/index.php",
            "line": 15,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_GET['logout']==1)     { include(\"includes\/logout_process.inc\");}"
        },
        {
            "file": "archives\/Sharing\/index.php",
            "line": 21,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_GET[\"showlogin\"]==1 )  { include(\"includes\/login_form.inc\");}"
        },
        {
            "file": "archives\/Sharing\/joingroup.php",
            "line": 26,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"joingroup\"]) ) {"
        },
        {
            "file": "archives\/Sharing\/joingroup.php",
            "line": 27,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from members where member_email = '.qq($_POST[\"groupemail\"]);"
        },
        {
            "file": "archives\/Sharing\/joingroup.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from communities where member_ID = '.$record[\"member_ID\"].' and password = '.qq($_POST[\"grouppassword\"]);"
        },
        {
            "file": "archives\/Sharing\/joingroup.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Plain text password storage",
            "code": "$query = 'select * from communities where member_ID = '.$record[\"member_ID\"].' and password = '.qq($_POST[\"grouppassword\"]);"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 30,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$pagespass = $_POST['pagespass'];"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 31,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/$member_email = $_POST['email'];"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 36,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST['submitcount']==\"Submit\" ) {"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 38,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo '<BR>'.$_POST['submitcount'];"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 39,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "\/\/echo '<BR>'.$_POST['rowcount'];"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 43,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "for ($i=1; $i<=$_POST['rowcount']; $i++) {"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 45,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = \"insert into member_communities ( member_ID, community_ID ) values ( '\".$_SESSION['member_ID'].\"' , '\".$_POST[$varname].\"' )\";"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 51,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ($_POST['submit2'] == \"Register\") {"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 55,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query5 = \"select * from members where member_email = \".qq($_POST['email']);"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 64,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$temp2 = $_POST['pagespass'];"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 65,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = \"INSERT INTO members (`member_fname`, `member_email`, `member_password`, `member_lname`, `member_pcode`) VALUES ('\".$_POST['fname'].\"', '\".$_POST['email'].\"', '\".$temp2.\"', '\".$_POST['lname'].\"', '\".$_POST['pcode'].\"')\";"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 69,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$_SESSION['member_email'] = $_POST['email'];"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 72,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query3 = 'select * from members where member_email = \"'.$_POST['email'].'\"';"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 77,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$_SESSION['member_email'] = $_POST['email'];"
        },
        {
            "file": "archives\/Sharing\/register.php",
            "line": 84,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$pcode5 = substr($_POST[\"pcode\"],0,5).\"*\"; $pcode6 = substr($_POST[\"pcode\"],0,6).\"*\"; $pcode7 = substr($_POST[\"pcode\"],0,7).\"*\"; $pcode8 = substr($_POST[\"pcode\"],0,8);"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 19,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "echo cell2(\"search keywords\",'<input type=\"text\" name=\"keywords\" value=\"'.$_POST[\"keywords\"].'\">');"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 21,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_POST[\"item_type\"]==1){"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 23,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "} elseif ($_POST[\"item_type\"]==2) {"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 35,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"item_ID\"])) {"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 37,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$query = 'select * from things where thing_ID = '.qq($_POST[\"item_ID\"]);"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 54,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if (isset($_POST[\"search\"])) {"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 56,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "if ( $_POST[\"item_type\"]==1){"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 58,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "} elseif ($_POST[\"item_type\"]==2) {"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 66,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "' and member_communities.member_ID = '.$_SESSION[\"member_ID\"].' and thing_title like \"%'.$_POST[\"keywords\"].'%\" '.$temp_type;"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 76,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$button3 = '<input type=\"hidden\" name=\"keywords\" value=\"'.$_POST[\"keywords\"] .'\">';"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 77,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$button3 = '<input type=\"hidden\" name=\"item_type\" value=\"'.$_POST[\"item_type\"] .'\">';"
        },
        {
            "file": "archives\/Sharing\/search.php",
            "line": 78,
            "severity": "SECURITY",
            "message": "Unescaped user input detected",
            "code": "$button4 = '<input type=\"hidden\" name=\"search\" value=\"'.$_POST[\"search\"] .'\">';"
        }
    ],
    "defined_functions": {
        "calculateCost": {
            "file": "request_booking.php",
            "line": 140,
            "definition": "function calculateCost() {"
        },
        "qq": {
            "file": "includes\/miscfunctions.inc",
            "line": 3,
            "definition": "function qq($str) {"
        },
        "cell2": {
            "file": "includes\/miscfunctions.inc",
            "line": 22,
            "definition": "function cell2($str1,$str2) {"
        },
        "cell3": {
            "file": "includes\/miscfunctions.inc",
            "line": 27,
            "definition": "function cell3($str1,$str2,$str3) {"
        },
        "cell4": {
            "file": "includes\/miscfunctions.inc",
            "line": 32,
            "definition": "function cell4($str1,$str2,$str3,$str4) {"
        },
        "cell5": {
            "file": "includes\/miscfunctions.inc",
            "line": 37,
            "definition": "function cell5($str1,$str2,$str3,$str4,$str5) {"
        },
        "cell6": {
            "file": "includes\/miscfunctions.inc",
            "line": 42,
            "definition": "function cell6($str1,$str2,$str3,$str4,$str5,$str6) {"
        },
        "qecho": {
            "file": "includes\/miscfunctions.inc",
            "line": 49,
            "definition": "function qecho($str1,$str2) {"
        },
        "check_booking_availability": {
            "file": "includes\/booking_functions.inc",
            "line": 11,
            "definition": "function check_booking_availability($thing_ID, $start_date, $end_date) {"
        },
        "get_booking_status_text": {
            "file": "includes\/booking_functions.inc",
            "line": 28,
            "definition": "function get_booking_status_text($status) {"
        },
        "get_booking_status_color": {
            "file": "includes\/booking_functions.inc",
            "line": 40,
            "definition": "function get_booking_status_color($status) {"
        },
        "create_booking_request": {
            "file": "includes\/booking_functions.inc",
            "line": 52,
            "definition": "function create_booking_request($thing_ID, $member_ID, $start_date, $end_date, $notes = '') {"
        },
        "update_booking_status": {
            "file": "includes\/booking_functions.inc",
            "line": 86,
            "definition": "function update_booking_status($booking_ID, $new_status, $member_ID) {"
        },
        "get_member_bookings": {
            "file": "includes\/booking_functions.inc",
            "line": 125,
            "definition": "function get_member_bookings($member_ID, $as_owner = false) {"
        },
        "get_due_returns": {
            "file": "includes\/booking_functions.inc",
            "line": 151,
            "definition": "function get_due_returns($days_ahead = 1) {"
        },
        "format_display_date": {
            "file": "includes\/booking_functions.inc",
            "line": 177,
            "definition": "function format_display_date($date) {"
        },
        "calculate_loan_cost": {
            "file": "includes\/booking_functions.inc",
            "line": 182,
            "definition": "function calculate_loan_cost($thing_price, $days) {"
        },
        "generate_availability_calendar": {
            "file": "includes\/booking_functions.inc",
            "line": 187,
            "definition": "function generate_availability_calendar($thing_ID, $month = null, $year = null) {"
        },
        "create_notification": {
            "file": "includes\/notification_functions.inc",
            "line": 8,
            "definition": "function create_notification($member_ID, $type, $title, $message, $data = null, $priority = 3) {"
        },
        "get_member_notifications": {
            "file": "includes\/notification_functions.inc",
            "line": 27,
            "definition": "function get_member_notifications($member_ID, $limit = 10, $unread_only = false) {"
        },
        "mark_notification_read": {
            "file": "includes\/notification_functions.inc",
            "line": 51,
            "definition": "function mark_notification_read($notification_ID, $member_ID) {"
        },
        "get_unread_notification_count": {
            "file": "includes\/notification_functions.inc",
            "line": 63,
            "definition": "function get_unread_notification_count($member_ID) {"
        },
        "process_pending_notifications": {
            "file": "includes\/notification_functions.inc",
            "line": 77,
            "definition": "function process_pending_notifications($limit = 50) {"
        },
        "send_email_notification": {
            "file": "includes\/notification_functions.inc",
            "line": 135,
            "definition": "function send_email_notification($notification_data) {"
        },
        "get_notification_template": {
            "file": "includes\/notification_functions.inc",
            "line": 163,
            "definition": "function get_notification_template($template_name) {"
        },
        "replace_template_variables": {
            "file": "includes\/notification_functions.inc",
            "line": 180,
            "definition": "function replace_template_variables($template_text, $notification_data) {"
        },
        "get_notification_type_info": {
            "file": "includes\/notification_functions.inc",
            "line": 239,
            "definition": "function get_notification_type_info($type) {"
        },
        "format_notification_row": {
            "file": "includes\/notification_functions.inc",
            "line": 254,
            "definition": "function format_notification_row($notification) {"
        },
        "time_ago": {
            "file": "includes\/notification_functions.inc",
            "line": 267,
            "definition": "function time_ago($datetime) {"
        },
        "init_secure_connection": {
            "file": "includes\/security_functions.inc",
            "line": 21,
            "definition": "function init_secure_connection() {"
        },
        "secure_query": {
            "file": "includes\/security_functions.inc",
            "line": 52,
            "definition": "function secure_query($query, $params = [], $fetch_mode = 'all') {"
        },
        "qq_secure": {
            "file": "includes\/security_functions.inc",
            "line": 94,
            "definition": "function qq_secure($str) {"
        },
        "secure_password_hash": {
            "file": "includes\/security_functions.inc",
            "line": 111,
            "definition": "function secure_password_hash($password) {"
        },
        "secure_password_verify": {
            "file": "includes\/security_functions.inc",
            "line": 121,
            "definition": "function secure_password_verify($password, $hash) {"
        },
        "is_password_hashed": {
            "file": "includes\/security_functions.inc",
            "line": 130,
            "definition": "function is_password_hashed($password_field) {"
        },
        "secure_authenticate_user": {
            "file": "includes\/security_functions.inc",
            "line": 145,
            "definition": "function secure_authenticate_user($email, $password) {"
        },
        "secure_register_user": {
            "file": "includes\/security_functions.inc",
            "line": 179,
            "definition": "function secure_register_user($user_data) {"
        },
        "secure_input": {
            "file": "includes\/security_functions.inc",
            "line": 205,
            "definition": "function secure_input($input, $type = 'string') {"
        },
        "convert_legacy_query": {
            "file": "includes\/security_functions.inc",
            "line": 228,
            "definition": "function convert_legacy_query($legacy_query, $values = []) {"
        },
        "security_log": {
            "file": "includes\/security_functions.inc",
            "line": 247,
            "definition": "function security_log($message, $level = 'INFO') {"
        }
    },
    "include_dependencies": {
        "account.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/security_functions.inc",
                "line": 15,
                "statement": "include(\"includes\/security_functions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 16,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "add_listing.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 15,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "create_private.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 15,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "index.php": [
            {
                "path": "includes\/miscfunctions.inc",
                "line": 11,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/connect.inc",
                "line": 12,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/login_process.inc",
                "line": 14,
                "statement": "if (isset($_POST[\"Login\"]) && $_POST[\"Login\"]==\"Login\"){ include(\"includes\/login_process.inc\");};"
            },
            {
                "path": "includes\/logout_process.inc",
                "line": 15,
                "statement": "if (isset($_GET['logout']) && $_GET['logout']==1)     { include(\"includes\/logout_process.inc\");}"
            },
            {
                "path": "includes\/header2.inc",
                "line": 18,
                "statement": "include(\"includes\/header2.inc\");"
            },
            {
                "path": "includes\/login_form.inc",
                "line": 21,
                "statement": "if (isset($_GET[\"showlogin\"]) && $_GET[\"showlogin\"]==1 )  { include(\"includes\/login_form.inc\");}"
            }
        ],
        "joingroup.php": [
            {
                "path": "includes\/connect.inc",
                "line": 10,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 11,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 12,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "my_bookings.php": [
            {
                "path": "includes\/connect.inc",
                "line": 11,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 12,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/booking_functions.inc",
                "line": 13,
                "statement": "include(\"includes\/booking_functions.inc\");"
            },
            {
                "path": "includes\/notification_functions.inc",
                "line": 14,
                "statement": "include(\"includes\/notification_functions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 15,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "notifications.php": [
            {
                "path": "includes\/connect.inc",
                "line": 18,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 19,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/notification_functions.inc",
                "line": 20,
                "statement": "include(\"includes\/notification_functions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 21,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "register.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/security_functions.inc",
                "line": 15,
                "statement": "include(\"includes\/security_functions.inc\");"
            },
            {
                "path": "includes\/header2.inc",
                "line": 16,
                "statement": "include(\"includes\/header2.inc\");"
            }
        ],
        "request_booking.php": [
            {
                "path": "includes\/connect.inc",
                "line": 20,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 21,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/booking_functions.inc",
                "line": 22,
                "statement": "include(\"includes\/booking_functions.inc\");"
            },
            {
                "path": "includes\/notification_functions.inc",
                "line": 23,
                "statement": "include(\"includes\/notification_functions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 24,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "search.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/security_functions.inc",
                "line": 15,
                "statement": "include(\"includes\/security_functions.inc\");"
            },
            {
                "path": "includes\/booking_functions.inc",
                "line": 16,
                "statement": "include(\"includes\/booking_functions.inc\");"
            },
            {
                "path": "includes\/notification_functions.inc",
                "line": 17,
                "statement": "include(\"includes\/notification_functions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 18,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "archives\/Sharing\/account.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 15,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "archives\/Sharing\/add_listing.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 15,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "archives\/Sharing\/create_private.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 15,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "archives\/Sharing\/index.php": [
            {
                "path": "includes\/miscfunctions.inc",
                "line": 11,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/connect.inc",
                "line": 12,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/login_process.inc",
                "line": 14,
                "statement": "if ($_POST[\"Login\"]==\"Login\"){ include(\"includes\/login_process.inc\");};"
            },
            {
                "path": "includes\/logout_process.inc",
                "line": 15,
                "statement": "if ( $_GET['logout']==1)     { include(\"includes\/logout_process.inc\");}"
            },
            {
                "path": "includes\/header2.inc",
                "line": 18,
                "statement": "include(\"includes\/header2.inc\");"
            },
            {
                "path": "includes\/login_form.inc",
                "line": 21,
                "statement": "if ($_GET[\"showlogin\"]==1 )  { include(\"includes\/login_form.inc\");}"
            }
        ],
        "archives\/Sharing\/joingroup.php": [
            {
                "path": "includes\/connect.inc",
                "line": 10,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 11,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 12,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "archives\/Sharing\/register.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header2.inc",
                "line": 15,
                "statement": "include(\"includes\/header2.inc\");"
            }
        ],
        "archives\/Sharing\/search.php": [
            {
                "path": "includes\/connect.inc",
                "line": 13,
                "statement": "include(\"includes\/connect.inc\");"
            },
            {
                "path": "includes\/miscfunctions.inc",
                "line": 14,
                "statement": "include(\"includes\/miscfunctions.inc\");"
            },
            {
                "path": "includes\/header.inc",
                "line": 15,
                "statement": "include(\"includes\/header.inc\");"
            }
        ],
        "includes\/booking_functions.inc": [
            {
                "path": "miscfunctions.inc",
                "line": 8,
                "statement": "require_once 'miscfunctions.inc';"
            }
        ],
        "includes\/login_process.inc": [
            {
                "path": "security_functions.inc",
                "line": 6,
                "statement": "require_once('security_functions.inc');"
            }
        ]
    }
}